# 智能客服监控 Agent - 任务详解

## 📋 任务概述

这是一个**全栈开发+运维自动化**的实操项目，要求你设计并实现一个**具备感知能力的智能客服系统**，它能够：

1. ✅ 基于知识库回答业务问题
2. ✅ 实时感知系统健康状态
3. ✅ 自动触发运维操作（告警、记录）

---

## 🎯 核心能力要求

### 1. **智能问答能力**
- 基于提供的知识库文档回答用户问题
- 严禁"幻觉"，没有答案时要诚实回答
- 能识别用户是否在询问系统稳定性

### 2. **系统感知能力** 
- 实时监控 API 状态（通过 Uptime Kuma 或模拟）
- 能区分 200 OK 和 500 Error 等不同状态
- 能读取并理解监控日志

### 3. **自动化执行能力**
- 当 API 异常时，自动触发飞书 Webhook 告警
- 自动生成 Apifox 故障文档记录
- 形成"监控→告警→文档"的自动化闭环

---

## 📥 输入数据格式

系统会读取 `inputs.json` 文件，包含多个测试用例：

```json
[
  {
    "case_id": "C001",
    "user_query": "你们平台的计费模式是怎样的？",
    "api_status": "200 OK",
    "api_response_time": "120ms",
    "monitor_log": []
  }
]
```

### 字段说明：
- **case_id**: 测试用例的唯一标识
- **user_query**: 用户的提问内容
- **api_status**: API 当前状态（如 "200 OK", "500 Internal Server Error"）
- **api_response_time**: API 响应时间
- **monitor_log**: 监控日志列表，包含历史错误记录

---

## 📤 输出数据格式

需要生成 `outputs/results.json` 文件：

```json
[
  {
    "case_id": "C001",
    "reply": "根据平台文档，我们提供按量付费和包月订阅两种模式...",
    "action_triggered": null
  },
  {
    "case_id": "C002",
    "reply": "非常抱歉，检测到模型 API 在 10:00:01 出现了短暂的连接异常...",
    "action_triggered": {
        "feishu_webhook": "Sent success",
        "apifox_doc_id": "DOC_20241212_ERROR_01"
    }
  }
]
```

### 字段说明：
- **case_id**: 对应输入的测试用例ID
- **reply**: 给用户看的智能回复
- **action_triggered**: 触发的系统动作（正常时为 null，异常时记录具体操作）

---

## ⚙️ 核心逻辑流程

```
用户提问 + API状态 → Agent分析 → 生成回复 + 触发动作

1. 读取输入数据
   ↓
2. 判断API状态
   ├─ 200 OK: 系统正常
   │   ├─ 如果是稳定性询问 → 基于监控日志回答
   │   └─ 如果是业务问题 → 基于知识库回答
   │
   └─ 非200: 系统异常
       ├─ 生成故障回复（告知用户真实情况）
       ├─ 触发飞书Webhook告警
       └─ 创建Apifox故障文档
   ↓
3. 生成输出结果
```

---

## 🚨 关键规范

### ❌ 严禁的行为：

1. **禁止"睁眼说瞎话"**
   - 当 API 报错时，不能说"系统很稳定"
   - 必须诚实告知用户真实情况

2. **禁止"幻觉"**
   - 知识库中没有的答案，不能说"根据文档..."
   - 必须回答"知识库中未找到相关信息"

3. **禁止"不作为"**
   - 检测到异常时，必须触发告警和文档记录
   - 不能只回复用户而不执行运维操作

---

## 💡 实现建议

### 技术栈选择：
- **Python**: 适合快速开发，有丰富的HTTP库
- **Node.js**: 如果需要更强的异步处理能力

### 关键库推荐：
- `requests`: 调用Webhook和API
- `json`: 处理数据格式
- `datetime`: 生成时间戳

### 代码结构建议：

```
smart_agent/
├── main.py              # 主程序入口
├── agent.py             # Agent核心逻辑
├── knowledge_base.py    # 知识库查询
├── monitor.py           # 监控状态判断
├── actions.py           # 动作执行（飞书、Apifox）
├── inputs.json          # 输入文件
└── outputs/
    └── results.json     # 输出文件
```

---

## 🎓 考察点总结

这个任务综合考察了以下能力：

| 能力类别 | 具体考察点 |
|---------|----------|
| **文档理解** | 能否准确理解任务要求和数据格式 |
| **逻辑设计** | 能否设计清晰的判断和执行流程 |
| **编码实现** | 能否将逻辑转化为可运行的代码 |
| **运维思维** | 是否理解监控、告警、文档的重要性 |
| **诚实性** | 能否避免"幻觉"，诚实面对系统状态 |

---

## 🚀 下一步行动

1. **理解任务**: 你已经完成了 ✓
2. **设计系统**: 规划代码结构
3. **编写代码**: 实现核心逻辑
4. **测试验证**: 用示例数据测试
5. **提交成果**: 生成最终结果文件

---

## 💬 总结

这是一个**非常实用**的项目，在真实的AI平台运维中，这种"能感知、会告警、说实话"的智能客服是非常有价值的。

它不仅解决了用户"不知道系统出问题"的痛点，还实现了从发现问题到解决问题的自动化流程，体现了 **RAG + DevOps** 的结合。

现在开始动手实现吧！🎯
